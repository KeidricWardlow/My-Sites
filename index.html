<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Word Frequency</title>
        <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans&display=swap" rel="stylesheet">
        <style>
            body {
                font-family: 'Josefin Sans', sans-serif;
                margin: 0;
                padding: 0;
                height: 100vh;
                display: flex;
                justify-content: center;
                align-items: center;
                background: linear-gradient(to right, teal, lightgreen, cyan);
                overflow: hidden;
            }

            .container {
                display: flex;
                flex-direction: column;
                width: 90%;
                max-width: 700px;
                min-width: 300px;
                max-height: 95vh;
                background: white;
                border: 2px solid black;
                border-radius: 12px;
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
                padding: 15px;
                overflow: auto;
            }

            .button-container {
                display: flex;
                justify-content: center;
                flex-wrap: wrap;
                gap: 10px;
                margin-bottom: 10px;
            }

            input[type="file"] {
                padding: 5px;
            }

            .input-output-container {
                display: flex;
                flex-direction: column;
                width: 100%;
                flex-grow: 1;
                overflow: hidden;
            }

            textarea {
                width: 100%;
                border: 1px solid black;
                border-radius: 8px;
                margin-bottom: 5px;
                padding: 10px;
                font-family: 'Josefin Sans', sans-serif;
                resize: none;
                height: 150px;
                overflow-y: auto;
                box-sizing: border-box;
            }

            .mode-label {
                font-weight: bold;
                margin-bottom: 5px;
            }

            .word-count {
                width: 100%;
                padding: 10px;
                border: 1px solid black;
                border-radius: 8px;
                overflow-y: auto;
                max-height: 250px;
                box-sizing: border-box;
            }

            button {
                padding: 10px 20px;
                background-color: darkred;
                color: white;
                border-radius: 5px;
                cursor: pointer;
                font-family: 'Josefin Sans', Times, serif;
            }

            button:hover {
                background: linear-gradient(to right, yellow, green);
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="button-container">
                <input type="file" id="fileInput" accept=".txt" />
            </div>
            <div class="input-output-container">
                <textarea id="textInput" placeholder="Enter text here..."></textarea>
                <div class="mode-label" id="modeLabel">Display Mode: Alphabetical</div>
                <div id="wordCount" class="word-count"></div>
            </div>
            <div class="button-container">
                <button id="loremIpsumButton">Sample Text</button>
                <button id="exportInputButton">Export Input (CSV)</button>
                <button id="exportWordCountButton">Export Word Count (CSV)</button>
                <button id="clearAllButton">Clear All</button>
                <button id="toggleOrderButton">Toggle Display Order</button>
            </div>
        </div>
        <script>
            let currentWordCount = {};
            let currentSortMode = "alpha";
            const fileInput = document.getElementById('fileInput');
            const textInput = document.getElementById('textInput');
            const wordCountDiv = document.getElementById('wordCount');
            const modeLabel = document.getElementById('modeLabel');
            fileInput.addEventListener('change', e => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = e => {
                        textInput.value = e.target.result;
                        countWords(e.target.result);
                    };
                    reader.readAsText(file);
                }
            });
            textInput.addEventListener('input', function() {
                countWords(this.value);
            });

            function countWords(text) {
                const words = text.match(/\b\w+\b/g);
                currentWordCount = {};
                if (words) {
                    words.forEach(word => {
                        const lower = word.toLowerCase();
                        currentWordCount[lower] = (currentWordCount[lower] || 0) + 1;
                    });
                }
                displayWordCount();
            }

            function displayWordCount() {
                modeLabel.textContent = `Display Mode: ${currentSortMode === "alpha" ? "Alphabetical" : "Frequency"}`;
                let entries = Object.entries(currentWordCount);
                if (currentSortMode === "freq") entries.sort((a, b) => b[1] - a[1]);
                else entries.sort((a, b) => a[0].localeCompare(b[0]));
                wordCountDiv.innerHTML = entries.map(([w, c]) => `${w}: ${c}`).join(' < br > ');
                }

                function exportCSV(filename, rows) {
                    const csvContent = rows.map(r => r.map(i => `"${i}"`).join(",")).join("\n");
                    const blob = new Blob([csvContent], {
                        type: 'text/csv;charset=utf-8;'
                    });
                    const link = document.createElement("a");
                    link.href = URL.createObjectURL(blob);
                    link.download = filename;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                }
                document.getElementById('loremIpsumButton').addEventListener('click', () => {
                    const text = `Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.`;
                    textInput.value = text;
                    countWords(text);
                });
                document.getElementById('exportInputButton').addEventListener('click', () => {
                    if (!textInput.value.trim()) {
                        alert("No input text to export.");
                        return;
                    }
                    const lines = textInput.value.split(/\r?\n/).map(line => [line]);
                    exportCSV("input_text.csv", [
                        ["Input Text"], ...lines
                    ]);
                });
                document.getElementById('exportWordCountButton').addEventListener('click', () => {
                    if (Object.keys(currentWordCount).length === 0) {
                        alert("No word count to export.");
                        return;
                    }
                    const proceed = confirm("Click OK to proceed with exporting current display mode, Cancel to exit.");
                    if (!proceed) return;
                    let entries = Object.entries(currentWordCount);
                    if (currentSortMode === "freq") entries.sort((a, b) => b[1] - a[1]);
                    else entries.sort((a, b) => a[0].localeCompare(b[0]));
                    const rows = [
                        ["Word", "Count"], ...entries
                    ];
                    exportCSV("word_count.csv", rows);
                });
                document.getElementById('clearAllButton').addEventListener('click', () => {
                    textInput.value = '';
                    wordCountDiv.innerHTML = '';
                    currentWordCount = {};
                    currentSortMode = "alpha";
                    modeLabel.textContent = "Display Mode: Alphabetical";
                    fileInput.value = '';
                });
                document.getElementById('toggleOrderButton').addEventListener('click', () => {
                    if (Object.keys(currentWordCount).length === 0) {
                        alert("No word count to toggle.");
                        return;
                    }
                    currentSortMode = currentSortMode === "alpha" ? "freq" : "alpha";
                    displayWordCount();
                });
        </script>
    </body>
</html>